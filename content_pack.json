{
  "v": "1",
  "id": "e7e0dcb4-b629-40b9-802e-7cb223b48343",
  "rev": 6,
  "name": "pihole",
  "summary": "Provides all the content needed to utilize pihole with graylog",
  "description": "Forked from https://github.com/chateaulav/pihole. Original Description: \"built and based off of https://jalogisch.de/2017/der-eigene-dns-resolver-zuhause/, your own dns resolver (at home) by Jan Doberstein. Includes setting GeoIP, so ensure you download the current City db from Maxmind, and install the current Threat intelligence content packs. A seperate input is established to collect only pihole syslog traffic.\"\n\nForked to make tweaks to grok patterns that were broken for whatever reason (best guess is that pihole syslog format changed). Also fixed some broken dashboards. ",
  "vendor": "Chateau-Lav",
  "url": "https://github.com/Chateau-Lav/pihole",
  "parameters": [],
  "entities": [
    {
      "v": "1",
      "type": {
        "name": "dashboard",
        "version": "2"
      },
      "id": "f0d5ae5d-d5cd-45f9-bbd8-6fe2bbdba722",
      "data": {
        "summary": {
          "@type": "string",
          "@value": ""
        },
        "search": {
          "queries": [
            {
              "id": "5e351231-6c34-41ce-9270-0f396abffa2c",
              "timerange": {
                "range": 300,
                "type": "relative"
              },
              "filters": [],
              "query": {
                "type": "elasticsearch",
                "query_string": ""
              },
              "search_types": [
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": ""
                  },
                  "name": "chart",
                  "timerange": {
                    "range": 86400,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "count()",
                      "field": null
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "query_answer_geolocation"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "8e86e2dc-0463-48ec-9a73-fcd440f03e86",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "source:pihole AND threat_indicated:true"
                  },
                  "name": "chart",
                  "timerange": {
                    "range": 86400,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "Message Count",
                      "field": null
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "9fc6d5dc-168a-4062-99bf-16a2929979b7",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "programname:dnsmasq AND NOT query_action:\"/etc/pihole/custom.list\" AND NOT query_domain:\"result\""
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 86400,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "count()",
                      "field": null
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "query_domain"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "4468d74e-84ac-436f-af2d-91008f5f6b82",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "application_name:pihole AND threat_indicated:true AND _exists_:threat_names"
                  },
                  "name": "chart",
                  "timerange": {
                    "range": 86400,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "count()",
                      "field": null
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "threat_names"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "1dd3c8d2-c27a-4de7-8952-e76b4fcbdb8e",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "gravity_answer:\"blocked\""
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 86400,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "count()",
                      "field": null
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "query_domain"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "54ff7037-1cb4-4707-b495-a2c2319869b9",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "source:pihole AND threat_indicated:true"
                  },
                  "name": "trend",
                  "timerange": {
                    "source": "search_type",
                    "id": "9fc6d5dc-168a-4062-99bf-16a2929979b7",
                    "offset": "1i",
                    "type": "offset"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "Message Count",
                      "field": null
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "03a45e79-9cf3-4aa5-a57a-81a6dbd0365c",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "gravity_answer:blocked"
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 86400,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "Message Count",
                      "field": null
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "6ba40c76-3d11-41fa-ab7b-e87b047a0a3b",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "_exists_:query_answer_whois_organization"
                  },
                  "name": "chart",
                  "timerange": {
                    "range": 3600,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "count()",
                      "field": null
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "query_answer_whois_organization"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "a7434476-ac31-47dc-978f-08c727b6129d",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "gravity_answer:blocked"
                  },
                  "name": "trend",
                  "timerange": {
                    "source": "search_type",
                    "id": "6ba40c76-3d11-41fa-ab7b-e87b047a0a3b",
                    "offset": "1i",
                    "type": "offset"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "Message Count",
                      "field": null
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "b35212f9-f47a-4e95-9ecd-319c3c91148c",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "source:pihole AND query_action:query*"
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 86400,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "Message Count",
                      "field": "query_action"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "1bc9259b-1809-44b8-b327-3f17196b91a8",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "_exists_:query_source"
                  },
                  "name": "chart",
                  "timerange": {
                    "range": 86400,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "count()",
                      "field": null
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "query_source"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "28badf56-4216-460d-a2d8-e8a73cba59fd",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "source:pihole AND query_action:query*"
                  },
                  "name": "trend",
                  "timerange": {
                    "source": "search_type",
                    "id": "1bc9259b-1809-44b8-b327-3f17196b91a8",
                    "offset": "1i",
                    "type": "offset"
                  },
                  "column_limit": null,
                  "streams": [],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "Message Count",
                      "field": "query_action"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "4e5857ae-bfbf-4fd2-8a15-5ccf9cb602da",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                }
              ]
            }
          ],
          "parameters": [],
          "requires": {},
          "owner": "admin",
          "created_at": "2025-01-07T15:07:20.379Z"
        },
        "created_at": "2020-05-24T17:47:28.269Z",
        "requires": {},
        "state": {
          "5e351231-6c34-41ce-9270-0f396abffa2c": {
            "selected_fields": null,
            "static_message_list_id": null,
            "titles": {
              "tab": {
                "title": "DNS Intel"
              },
              "widget": {
                "9346af21-e18d-4014-a7e5-7b7944bd0b20": "DNS Location Requested IP (from answers)",
                "40fe2a5d-109b-4698-b0ab-74871d2e3363": "DNS Activities (24h)",
                "9d4133c9-d7dd-43c6-ab35-c40c47152133": "Threat Names (24h)",
                "125ca269-d7cc-4ad8-b1b8-8b55e6fe5bc6": "Blocked Domains (24h)",
                "375151f2-1557-4c5c-8457-fe4125242308": "Blackholed Requests (24h)",
                "6141e765-67f7-41a8-b696-04298bd125d2": "Threat Indicated (24h)",
                "7d76dcfe-e92f-4d9d-a514-a0efd19911e0": "DNS Location Requested IP (from answers) (copy)",
                "dd60e605-aeb4-4e16-a4c8-a3079a2fe953": "DNS Clients (24h)",
                "c2e25aae-5719-46fb-a62e-08c4b056cc4d": "DNS Querys (24h)",
                "c07f3ec8-8982-4b8f-a0b5-742e70371339": "Owning Companies (24h)"
              }
            },
            "widgets": [
              {
                "config": {
                  "visualization": "table",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 15,
                  "row_pivots": [
                    {
                      "fields": [
                        "threat_names"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": null
                      },
                      "function": "count()"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": null,
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "application_name:pihole AND threat_indicated:true AND _exists_:threat_names"
                },
                "timerange": {
                  "range": 86400,
                  "type": "relative"
                },
                "streams": [],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "9d4133c9-d7dd-43c6-ab35-c40c47152133",
                "filters": []
              },
              {
                "config": {
                  "visualization": "numeric",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [],
                  "series": [
                    {
                      "config": {
                        "name": "Message Count"
                      },
                      "function": "count()"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": {
                    "trend": true,
                    "trend_preference": "HIGHER"
                  },
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "gravity_answer:blocked"
                },
                "timerange": {
                  "from": 86400,
                  "type": "relative"
                },
                "streams": [],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "375151f2-1557-4c5c-8457-fe4125242308",
                "filters": []
              },
              {
                "config": {
                  "visualization": "table",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 15,
                  "row_pivots": [
                    {
                      "fields": [
                        "query_domain"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": null
                      },
                      "function": "count()"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": {
                    "pinned_columns": []
                  },
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "programname:dnsmasq AND NOT query_action:\"/etc/pihole/custom.list\" AND NOT query_domain:\"result\""
                },
                "timerange": {
                  "from": 86400,
                  "type": "relative"
                },
                "streams": [],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "40fe2a5d-109b-4698-b0ab-74871d2e3363",
                "filters": []
              },
              {
                "config": {
                  "visualization": "numeric",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [],
                  "series": [
                    {
                      "config": {
                        "name": "Message Count"
                      },
                      "function": "count(query_action)"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": {
                    "trend": true,
                    "trend_preference": "NEUTRAL"
                  },
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "source:pihole AND query_action:query*"
                },
                "timerange": {
                  "from": 86400,
                  "type": "relative"
                },
                "streams": [],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "c2e25aae-5719-46fb-a62e-08c4b056cc4d",
                "filters": []
              },
              {
                "config": {
                  "visualization": "table",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 15,
                  "row_pivots": [
                    {
                      "fields": [
                        "query_answer_whois_organization"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": null
                      },
                      "function": "count()"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": null,
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "_exists_:query_answer_whois_organization"
                },
                "timerange": {
                  "range": 3600,
                  "type": "relative"
                },
                "streams": [],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "c07f3ec8-8982-4b8f-a0b5-742e70371339",
                "filters": []
              },
              {
                "config": {
                  "visualization": "table",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 15,
                  "row_pivots": [
                    {
                      "fields": [
                        "query_domain"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": null
                      },
                      "function": "count()"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": null,
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "gravity_answer:\"blocked\""
                },
                "timerange": {
                  "from": 86400,
                  "type": "relative"
                },
                "streams": [],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "125ca269-d7cc-4ad8-b1b8-8b55e6fe5bc6",
                "filters": []
              },
              {
                "config": {
                  "visualization": "numeric",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [],
                  "series": [
                    {
                      "config": {
                        "name": "Message Count"
                      },
                      "function": "count()"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": {
                    "trend": true,
                    "trend_preference": "LOWER"
                  },
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "source:pihole AND threat_indicated:true"
                },
                "timerange": {
                  "range": 86400,
                  "type": "relative"
                },
                "streams": [],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "6141e765-67f7-41a8-b696-04298bd125d2",
                "filters": []
              },
              {
                "config": {
                  "visualization": "map",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 15,
                  "row_pivots": [
                    {
                      "fields": [
                        "query_answer_geolocation"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": null
                      },
                      "function": "count()"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": null,
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": ""
                },
                "timerange": {
                  "range": 86400,
                  "type": "relative"
                },
                "streams": [],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "9346af21-e18d-4014-a7e5-7b7944bd0b20",
                "filters": []
              },
              {
                "config": {
                  "visualization": "table",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 15,
                  "row_pivots": [
                    {
                      "fields": [
                        "query_source"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": null
                      },
                      "function": "count()"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": null,
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "_exists_:query_source"
                },
                "timerange": {
                  "range": 86400,
                  "type": "relative"
                },
                "streams": [],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "dd60e605-aeb4-4e16-a4c8-a3079a2fe953",
                "filters": []
              }
            ],
            "widget_mapping": {
              "9346af21-e18d-4014-a7e5-7b7944bd0b20": [
                "8e86e2dc-0463-48ec-9a73-fcd440f03e86"
              ],
              "40fe2a5d-109b-4698-b0ab-74871d2e3363": [
                "4468d74e-84ac-436f-af2d-91008f5f6b82"
              ],
              "9d4133c9-d7dd-43c6-ab35-c40c47152133": [
                "1dd3c8d2-c27a-4de7-8952-e76b4fcbdb8e"
              ],
              "125ca269-d7cc-4ad8-b1b8-8b55e6fe5bc6": [
                "54ff7037-1cb4-4707-b495-a2c2319869b9"
              ],
              "375151f2-1557-4c5c-8457-fe4125242308": [
                "b35212f9-f47a-4e95-9ecd-319c3c91148c",
                "6ba40c76-3d11-41fa-ab7b-e87b047a0a3b"
              ],
              "6141e765-67f7-41a8-b696-04298bd125d2": [
                "9fc6d5dc-168a-4062-99bf-16a2929979b7",
                "03a45e79-9cf3-4aa5-a57a-81a6dbd0365c"
              ],
              "dd60e605-aeb4-4e16-a4c8-a3079a2fe953": [
                "28badf56-4216-460d-a2d8-e8a73cba59fd"
              ],
              "c2e25aae-5719-46fb-a62e-08c4b056cc4d": [
                "1bc9259b-1809-44b8-b327-3f17196b91a8",
                "4e5857ae-bfbf-4fd2-8a15-5ccf9cb602da"
              ],
              "c07f3ec8-8982-4b8f-a0b5-742e70371339": [
                "a7434476-ac31-47dc-978f-08c727b6129d"
              ]
            },
            "positions": {
              "9346af21-e18d-4014-a7e5-7b7944bd0b20": {
                "col": 1,
                "row": 3,
                "height": 4,
                "width": 6
              },
              "40fe2a5d-109b-4698-b0ab-74871d2e3363": {
                "col": 10,
                "row": 1,
                "height": 4,
                "width": 3
              },
              "9d4133c9-d7dd-43c6-ab35-c40c47152133": {
                "col": 4,
                "row": 7,
                "height": 5,
                "width": 3
              },
              "125ca269-d7cc-4ad8-b1b8-8b55e6fe5bc6": {
                "col": 7,
                "row": 3,
                "height": 9,
                "width": 3
              },
              "375151f2-1557-4c5c-8457-fe4125242308": {
                "col": 7,
                "row": 1,
                "height": 2,
                "width": 3
              },
              "6141e765-67f7-41a8-b696-04298bd125d2": {
                "col": 4,
                "row": 1,
                "height": 2,
                "width": 3
              },
              "dd60e605-aeb4-4e16-a4c8-a3079a2fe953": {
                "col": 1,
                "row": 7,
                "height": 5,
                "width": 3
              },
              "c2e25aae-5719-46fb-a62e-08c4b056cc4d": {
                "col": 1,
                "row": 1,
                "height": 2,
                "width": 3
              },
              "c07f3ec8-8982-4b8f-a0b5-742e70371339": {
                "col": 10,
                "row": 5,
                "height": 7,
                "width": 3
              }
            },
            "formatting": {
              "highlighting": []
            },
            "display_mode_settings": {
              "positions": {}
            }
          }
        },
        "properties": [],
        "owner": null,
        "title": {
          "@type": "string",
          "@value": "DNS Intel"
        },
        "type": "DASHBOARD",
        "description": {
          "@type": "string",
          "@value": "Client and DNS Lookup Information"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.4+7528370"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "020dcb94-12fc-4f9a-b139-8872c6263547",
      "data": {
        "name": "HOUR",
        "pattern": "(?:2[0123]|[01]?[0-9])"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.3.0+4ea5649"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "c515c20f-d0bf-4946-8167-d643775541be",
      "data": {
        "name": "MINUTE",
        "pattern": "(?:[0-5][0-9])"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.3.0+4ea5649"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "756dad76-b7c8-489b-b23d-b9d980e94b3a",
      "data": {
        "name": "MONTHDAY",
        "pattern": "(?:(?:0[1-9])|(?:[12][0-9])|(?:3[01])|[1-9])"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.3.0+4ea5649"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "26563660-bf3f-41fd-b9f4-73f2ec6ccf28",
      "data": {
        "name": "NOTSPACE",
        "pattern": "\\S+"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.3.0+4ea5649"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "4af2dac5-8ad6-465f-93f2-b008d3f3b0b3",
      "data": {
        "name": "NOTSPACE",
        "pattern": "\\S+"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.4+7528370"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "5501c926-fc1d-4fe6-8595-fa6c9c3060e5",
      "data": {
        "name": "POSINT",
        "pattern": "\\b(?:[1-9][0-9]*)\\b"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.3.0+4ea5649"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "6f3ec9f4-7a90-42a6-9712-8bda7dabde1a",
      "data": {
        "name": "POSINT",
        "pattern": "\\b(?:[1-9][0-9]*)\\b"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.4+7528370"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "b414a142-d84a-4d41-b9b0-ed570e3e6934",
      "data": {
        "name": "SECOND",
        "pattern": "(?:(?:[0-5]?[0-9]|60)(?:[:.,][0-9]+)?)"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.3.0+4ea5649"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "b46ca5b8-b24a-47c3-b9de-ae60486a393f",
      "data": {
        "name": "SPACE",
        "pattern": "\\s*"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.3.0+4ea5649"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "b289e143-c9cd-430d-989f-0949274c993a",
      "data": {
        "name": "SYSLOGTIMESTAMP",
        "pattern": "%{MONTH} +%{MONTHDAY} %{TIME}"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.3.0+4ea5649"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "6d47253a-43fd-47d9-b2ed-efaa5c880de9",
      "data": {
        "name": "TIME",
        "pattern": "(?!<[0-9])%{HOUR}:%{MINUTE}(?::%{SECOND})(?![0-9])"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.3.0+4ea5649"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "92e0c9c3-3dbc-49e4-882e-5b7c09410cbb",
      "data": {
        "name": "WORD",
        "pattern": "\\b\\w+\\b"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.3.0+4ea5649"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "9f72ab4a-6619-4aaf-be19-42eae05f5ab9",
      "data": {
        "name": "DNSMASQ",
        "pattern": "%{WORD:programname}\\[%{POSINT:procid}\\]: ((?:%{WORD:query_action}\\[%{WORD:query_type}\\])|(?:gravity %{WORD:gravity_answer})|(?:%{WORD:query_action})|(?:%{PATH:custom_list})) %{NOTSPACE:query_domain} (?:from %{NOTSPACE:query_source}|is %{NOTSPACE:query_answer}|to %{NOTSPACE:query_target})"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.4+7528370"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "09a49bd0-c2be-427b-903a-ac29fd3975f4",
      "data": {
        "name": "PATH",
        "pattern": "(?:%{UNIXPATH}|%{WINPATH})"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.4+7528370"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "f57777eb-cf7f-4e3b-ab17-01865b97cf52",
      "data": {
        "name": "WORD",
        "pattern": "\\b\\w+\\b"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.4+7528370"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "0ceb5fe8-115e-4ffe-ae4d-2cd0abb7f9f6",
      "data": {
        "name": "NOTSPACE",
        "pattern": "\\S+"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.4+7528370"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "5b49a3a0-5c3c-4e55-9e3b-cf467090a8cb",
      "data": {
        "name": "POSINT",
        "pattern": "\\b(?:[1-9][0-9]*)\\b"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.4+7528370"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "8d78156b-31fc-400f-a6cb-e98945249dba",
      "data": {
        "name": "WINPATH",
        "pattern": "(?>[A-Za-z]+:|\\\\)(?:\\\\[^\\\\?*]*)+"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.4+7528370"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "grok_pattern",
        "version": "1"
      },
      "id": "b329e6fa-9015-4e04-abf5-a5d7b6dcd396",
      "data": {
        "name": "UNIXPATH",
        "pattern": "(/([\\w_%!$@:.,~-]+|\\\\.)*)+"
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.4+7528370"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "14dcd60b-3abf-4e79-97f3-f30602dfb7c7",
      "data": {
        "title": {
          "@type": "string",
          "@value": "piHole Syslog"
        },
        "configuration": {
          "port": {
            "@type": "integer",
            "@value": 1515
          },
          "recv_buffer_size": {
            "@type": "integer",
            "@value": 1048576
          },
          "force_rdns": {
            "@type": "boolean",
            "@value": false
          },
          "allow_override_date": {
            "@type": "boolean",
            "@value": false
          },
          "override_source": {
            "@type": "string",
            "@value": "pihole"
          },
          "bind_address": {
            "@type": "string",
            "@value": "0.0.0.0"
          },
          "expand_structured_data": {
            "@type": "boolean",
            "@value": false
          },
          "store_full_message": {
            "@type": "boolean",
            "@value": true
          },
          "number_worker_threads": {
            "@type": "integer",
            "@value": 4
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.syslog.udp.SyslogUDPInput"
        },
        "global": {
          "@type": "boolean",
          "@value": true
        },
        "extractors": [
          {
            "target_field": {
              "@type": "string",
              "@value": "application_name"
            },
            "condition_value": {
              "@type": "string",
              "@value": "pihole"
            },
            "order": {
              "@type": "integer",
              "@value": 0
            },
            "converters": [],
            "configuration": {
              "regex_value": {
                "@type": "string",
                "@value": "(pihole)"
              }
            },
            "source_field": {
              "@type": "string",
              "@value": "message"
            },
            "title": {
              "@type": "string",
              "@value": "pihole_application_name"
            },
            "type": {
              "@type": "string",
              "@value": "REGEX"
            },
            "cursor_strategy": {
              "@type": "string",
              "@value": "COPY"
            },
            "condition_type": {
              "@type": "string",
              "@value": "STRING"
            }
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.3.0+4ea5649"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "cf3914aa-336e-46e3-9177-af05d5a15632",
      "data": {
        "name": {
          "@type": "string",
          "@value": "geolite2-city"
        },
        "title": {
          "@type": "string",
          "@value": "GeoLite2-City"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "maxmind_geoip"
          },
          "path": {
            "@type": "string",
            "@value": "/etc/graylog/server/GeoLite2-City.mmdb"
          },
          "database_type": {
            "@type": "string",
            "@value": "MAXMIND_CITY"
          },
          "check_interval": {
            "@type": "long",
            "@value": 0
          },
          "check_interval_unit": {
            "@type": "string",
            "@value": "MINUTES"
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.3.0+4ea5649"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_cache",
        "version": "1"
      },
      "id": "0debec3e-0190-4f51-b546-e6e75c27d7cb",
      "data": {
        "name": {
          "@type": "string",
          "@value": "geolite2-city"
        },
        "title": {
          "@type": "string",
          "@value": "GeoLite2-City"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "guava_cache"
          },
          "max_size": {
            "@type": "integer",
            "@value": 1000
          },
          "expire_after_access": {
            "@type": "long",
            "@value": 60
          },
          "expire_after_access_unit": {
            "@type": "string",
            "@value": "SECONDS"
          },
          "expire_after_write": {
            "@type": "long",
            "@value": 0
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.3.0+4ea5649"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "9de15e3d-d687-466f-a974-84608ed8a18d",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "0debec3e-0190-4f51-b546-e6e75c27d7cb"
        },
        "name": {
          "@type": "string",
          "@value": "GeoLite2-City"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "cf3914aa-336e-46e3-9177-af05d5a15632"
        },
        "title": {
          "@type": "string",
          "@value": "GeoLite2-City"
        },
        "default_single_value": {
          "@type": "string",
          "@value": ""
        },
        "description": {
          "@type": "string",
          "@value": ""
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=3.3.0+4ea5649"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline",
        "version": "1"
      },
      "id": "ba3ddd63-6e95-4686-813f-f06e2eddea19",
      "data": {
        "title": {
          "@type": "string",
          "@value": "pihole / dnsmasq"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "pipeline \"pihole / dnsmasq\"\nstage 0 match either\nrule \"PiHole GeoIP Set\"\nstage 1 match either\nrule \"threatintel (dnsmasq)\"\nrule \"dnsmasq clean message\"\nstage 2 match either\nrule \"threatintel (2) inflate\"\nstage -1 match either\nrule \"dnsmasq split\"\nend"
        },
        "connected_streams": [
          {
            "@type": "string",
            "@value": "1158e9ee-3969-4dc7-b5dd-b16f89dcf93d"
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.4+7528370"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "e0d25abe-fa20-45d8-8da5-ea3b9bd38ec7",
      "data": {
        "title": {
          "@type": "string",
          "@value": "dnsmasq split"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"dnsmasq split\"\nwhen\n    has_field(\"source\") and contains (to_string($message.source), \"pihole\")\nthen\n let message_field = to_string($message.message); \n\n let action = grok(pattern: \"%{DNSMASQ}\", value: message_field, only_named_captures: true);\n set_fields(action);\n set_field(\"pipeline\", \"dnsmasq split\");\n\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.4+7528370"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "8a00b8a2-51ca-4ffa-a58a-5df3d38e818f",
      "data": {
        "title": {
          "@type": "string",
          "@value": "dnsmasq clean message"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"dnsmasq clean message\"\nwhen\n    has_field(\"programname\") AND contains(to_string($message.programname), \"dnsmasq\")\nthen\n   let m = regex(\"^.+: (.+)$\", to_string($message.message));\n   let clean_message = m[\"0\"];\n  // Set a better message field without the prefix clutter.\n  set_field(\"message\", clean_message);\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.4+7528370"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "06c37edb-8ac2-49ae-ac1d-9af5434bfd89",
      "data": {
        "title": {
          "@type": "string",
          "@value": "threatintel (2) inflate"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"threatintel (2) inflate\"\nwhen\n  to_bool($message.query_answer_threat_indicated) OR to_bool($message.query_domain_threat_indicated)\nthen\n  set_field(\"threat_indicated\", true);\n  \n  // set debug mark\n  set_field(\"pipeline\", \"threatintel (2)\" );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.4+7528370"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "a051a1b0-a9bd-4798-b55d-348636f37298",
      "data": {
        "title": {
          "@type": "string",
          "@value": "PiHole GeoIP Set"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"PiHole GeoIP Set\"\nwhen\n    has_field(\"query_answer\") &&  ! cidr_match(\"10.0.0.0/8\", to_ip($message.query_answer)) ||\n    ! cidr_match(\"172.16.0.0/12\", to_ip($message.query_answer)) ||\n    ! cidr_match(\"192.168.0.0/16\", to_ip($message.query_answer))\nthen\n    let geo = lookup(\"GeoLite2-City\",to_string($message.query_answer));\n    set_field(\"query_answer_geolocation\", geo[\"coordinates\"]);\n    set_field(\"query_answer_country_code\", geo[\"country\"].iso_code);\n    set_field(\"query_answer_country_name\", geo[\"country\"].names.en);\n    set_field(\"query_answer_city_name\", geo[\"city\"].names.en);\n    set_field(\"pipeline\", \"Pihole GeoIP Set\");\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.4+7528370"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "c291d61a-3669-4b8e-965d-5fdcdc3c72d6",
      "data": {
        "title": {
          "@type": "string",
          "@value": "threatintel (dnsmasq)"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "rule \"threatintel (dnsmasq)\"\nwhen\n    has_field(\"query_answer\") OR has_field(\"query_domain\")\nthen\n\n  // Read the README!!\n  // https://github.com/Graylog2/graylog-plugin-threatintel\n\n  // first look up the IP that is in query_answer\n  let query_answer_intel = threat_intel_lookup_ip(to_string($message.query_answer), \"query_answer\");\n  set_fields(query_answer_intel);\n  \n  // look up DNS Requested Domain or Domain that is in response\n  let query_domain_intel = threat_intel_lookup_domain(to_string($message.query_domain), \"query_domain\");\n  set_fields(query_domain_intel);\n  \n  let whois_intel = whois_lookup_ip(to_string($message.query_answer), \"query_answer\");\n  set_fields(whois_intel);\n  \n  let intel = otx_lookup_ip(to_string($message.query_answer));\n  let intel = otx_lookup_domain(to_string($message.query_domain));\n\n  set_field(\"threat_indicated\", intel.otx_threat_indicated);\n  set_field(\"threat_ids\", intel.otx_threat_ids);\n  set_field(\"threat_names\", intel.otx_threat_names);\n  \n  // set debug mark\n  set_field(\"pipeline\", \"threatintel (1)\" );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.4+7528370"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream_title",
        "version": "1"
      },
      "id": "1158e9ee-3969-4dc7-b5dd-b16f89dcf93d",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Default Stream"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.4+7528370"
        }
      ]
    }
  ]
}
